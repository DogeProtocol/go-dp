package crosssign

import (
	"encoding/base64"
	"fmt"
	"github.com/DogeProtocol/dp/crypto/cryptobase"
	"github.com/stretchr/testify/assert"
	"strings"
	"testing"
)

var (
	error_1   = "[{\"This is my wallet\",\r\n  \"sig\": \"0x6c679b0b1f47bfc668bd67a217ffef3a0d645653b8ae7f25242bc1e7fac1511d7fc514e8a6c6199fc2c9a50648022cd549ba9a6a9def315a106fcc924a1903941c\",\r\n  \"versionTest\": \"2\"\r\n}]"
	error_1_1 = "{\r\n  \"addressTest\": \"0x4667Fc33E26911Ba828cc9F1bB4A0F47B1e383B1\",\r\n  \"msgTest\": \"This is my wallet\",\r\n  \"sig\": \"0x6c679b0b1f47bfc668bd67a217ffef3a0d645653b8ae7f25242bc1e7fac1511d7fc514e8a6c6199fc2c9a50648022cd549ba9a6a9def315a106fcc924a1903941c\",\r\n  \"versionTest\": \"2\"\r\n}"
	error_2   = "{\r\n  \"address\": \"0x4667Fc33E26911Ba828cc9F1bB4A0F47B1e383B1\",\r\n  \"msg\": \"This is my wallet\",\r\n  \"sig\": \"0x6c679b0b1f47bfc668bd67a217ffef3a0d645653b8ae7f25242bc1e7fac1511d7fc514e8a6c6199fc2c9a50648022cd549ba9a6a9def315a106fcc924a190394\",\r\n  \"version\": \"2\"\r\n}"
	error_3   = "{\r\n  \"address\": \"0x4667Fc33E26911Ba828cc9F1bB4A0F47B1e383B1\",\r\n  \"msg\": \"This is my wallet\",\r\n  \"sig\": \"0x6c679b0b1f47bfc668bd67a217ffef3a0d645653b8ae7f25242bc1e7fac1511d7fc514e8a6c6199fc2c9a50648022cd549ba9a6a9def315a106fcc924a1903942b\",\r\n  \"version\": \"2\"\r\n}"

	error_4   = "{\r\n  \"address\": \"0x5667Fc33E26911Ba828cc9F1bB4A0F47B1e383B1\",\r\n  \"msg\": \"This is my wallet\",\r\n  \"sig\": \"0x6c679b0b1f47bfc668bd67a217ffef3a0d645653b8ae7f25242bc1e7fac1511d7fc514e8a6c6199fc2c9a50648022cd549ba9a6a9def315a106fcc924a1903941c\",\r\n  \"version\": \"2\"\r\n}"
	error_4_1 = "{\r\n  \"address\": \"0x4667Fc33E26911Ba828cc9F1bB4A0F47B1e383B1\",\r\n  \"msg\": \"This is my wallet\",\r\n  \"sig\": \"0x8c679b0b1f47bfc668bd67a217ffef3a0d645653b8ae7f25242bc1e7fac1511d7fc514e8a6c6199fc2c9a50648022cd549ba9a6a9def315a106fcc924a1903941c\",\r\n  \"version\": \"2\"\r\n}"
	error_4_2 = "{\r\n  \"address\": \"0x4667Fc33E26911Ba828cc9F1bB4A0F47B1e383B1\",\r\n  \"msg\": \"This is my wallet1\",\r\n  \"sig\": \"0x8c679b0b1f47bfc668bd67a217ffef3a0d645653b8ae7f25242bc1e7fac1511d7fc514e8a6c6199fc2c9a50648022cd549ba9a6a9def315a106fcc924a1903941c\",\r\n  \"version\": \"2\"\r\n}"

	error_5 = "{\r\n  \"address\": \"0x466c33E26911Ba828cc9F1bB4A0F47B1e383B1\",\r\n  \"msg\": \"This is my wallet\",\r\n  \"sig\": \"0x6c679b0b1f47bfc668bd67a217ffef3a0d645653b8ae7f25242bc1e7fac1511d7fc514e8a6c6199fc2c9a50648022cd549ba9a6a9def315a106fcc924a1903941c\",\r\n  \"version\": \"2\"\r\n}"

	error_7 = "{\r\n  \"address\": \"0x5667Fc33E26911Ba828cc9F1bB4A0F47B1e383B1\",\r\n  \"msg\": \"This is my wallet\",\r\n  \"sig\": \"0x6c679b0b1f47bfc668bd67a217ffef3a0d645653b8ae7f25242bc1e7fac1511d7fc514e8a6c6199fc2c9a50648022cd549ba9a6a9def315a106fcc924a1903941c\",\r\n  \"version\": \"2\"\r\n}"

	success_1 = "{\r\n  \"address\": \"0xF422Ec881E87B934A165DB64132a87fbd1753daD\",\r\n  \"msg\": \"Test message waller\",\r\n  \"sig\": \"0x5c73e35d19d6656f826c82513a4523a8c789762bacfd1ce5127f24c1e61cd59f7779132c3a390294db158735e398c4e87b726b87bef44ad840a47ac6ca06ef8d1b\",\r\n  \"version\": \"2\"\r\n}"
	success_2 = "{\r\n  \"address\": \"0x4667Fc33E26911Ba828cc9F1bB4A0F47B1e383B1\",\r\n  \"msg\": \"This is my wallet\",\r\n  \"sig\": \"0x6c679b0b1f47bfc668bd67a217ffef3a0d645653b8ae7f25242bc1e7fac1511d7fc514e8a6c6199fc2c9a50648022cd549ba9a6a9def315a106fcc924a1903941c\",\r\n  \"version\": \"2\"\r\n}"
)

func TestCrossSign_Verification(t *testing.T) {
	err1 := CrossSignVerification(error_1)
	err11 := CrossSignVerification(error_1_1)

	err2 := CrossSignVerification(error_2)
	err3 := CrossSignVerification(error_3)

	err4 := CrossSignVerification(error_4)
	err41 := CrossSignVerification(error_4_1)
	err42 := CrossSignVerification(error_4_2)

	err5 := CrossSignVerification(error_5)
	err7 := CrossSignVerification(error_7)

	err8 := CrossSignVerification(success_1)
	err9 := CrossSignVerification(success_2)

	assert.Errorf(t, err1, err1.Error())
	assert.Errorf(t, err11, err11.Error())

	assert.Errorf(t, err2, err2.Error())
	assert.Errorf(t, err3, err3.Error())

	assert.Errorf(t, err4, err4.Error())
	assert.Errorf(t, err41, err41.Error())
	assert.Errorf(t, err42, err42.Error())

	assert.Errorf(t, err5, err5.Error())

	assert.Errorf(t, err7, err7.Error())

	assert.Equal(t, nil, err8)
	assert.Equal(t, nil, err9)
}

func TestGenesisValidator(t *testing.T) {
	ethAddr := "0xbC22f18344B750Cc46F37375ed7fb607b9C649cc"
	depKey, err := cryptobase.SigAlg.GenerateKey()
	if err != nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}

	valKey, err := cryptobase.SigAlg.GenerateKey()
	if err != nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}

	d, _ := cryptobase.SigAlg.SerializePrivateKey(depKey)
	fmt.Println("d pkey", base64.StdEncoding.EncodeToString(d))
	v, _ := cryptobase.SigAlg.SerializePrivateKey(valKey)
	fmt.Println("v pkey", base64.StdEncoding.EncodeToString(v))
	depositorAddr := cryptobase.SigAlg.PublicKeyToAddressNoError(&depKey.PublicKey).Hex()
	validatorAddr := cryptobase.SigAlg.PublicKeyToAddressNoError(&valKey.PublicKey).Hex()
	fmt.Println("ethAddr", ethAddr)
	fmt.Println("depositorAddr", depositorAddr)
	fmt.Println("validatorAddr", validatorAddr)

	amount := "5000000"

	details, err := SignGenesis(depKey, valKey, ethAddr, amount)
	if err != nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}

	if details.DepositorAddress != depositorAddr {
		t.Fatalf("failed")
	}

	if details.ValidatorAddress != validatorAddr {
		t.Fatalf("failed")
	}

	if details.Amount != amount {
		t.Fatalf("failed")
	}

	if details.EthAddress != ethAddr {
		t.Fatalf("failed")
	}
}

func TestGenesisValidatorStatic(t *testing.T) {
	details := &GenesisCrossSignDetails{
		EthAddress:        "0xbC22f18344B750Cc46F37375ed7fb607b9C649cc",
		DepositorAddress:  "0xeD303665Bf738C649Be0449146C2a3a06BF16fcd291f27F7e6238F3b6eAa1eDB",
		ValidatorAddress:  "0xCA35916aE38F1457b3cf72D70dAFBda203AC3a6f441fD8cc875F1724D6a63933",
		Amount:            "5000000",
		Message:           "I AGREE TO BECOME A GENESIS VALIDATOR FOR MAINNET. MY ETH ADDRESS IS 0xbC22f18344B750Cc46F37375ed7fb607b9C649cc. MY CORRESPONDING DEPOSITOR QUANTUM ADDRESS IS 0xeD303665Bf738C649Be0449146C2a3a06BF16fcd291f27F7e6238F3b6eAa1eDB AND VALIDATOR QUANTUM ADDRESS IS 0xCA35916aE38F1457b3cf72D70dAFBda203AC3a6f441fD8cc875F1724D6a63933. VALIDATOR AMOUNT IS 5000000 DOGEP.",
		QuantumSignature:  "041F820F7E0FFE090120DB5F0149D4FB6654E983C0FCA62D1B34C66BC1E59A82A0E379B1435D39CADDDF845701FDBA86374F14736BCFB2718CC99A0D3C068DB2F401DC82233610171B04C0AE600D4298DB18DFD5E1F0C7FBFC724F60885AE93F320D303D6E944061A55373E94338BA427C638DFD540AEA30A43E2DA83E99802F2C6F07DF2956B1E28C56717C64BEF7362D6016FEFB42D4E25BCCA926F9623F76F4D9573204AE053B7B9BC23AC54E23F6E7E39EEE7B0F3E27569A9CD25EE39882E62860E87E7465A98ACD30C30BFFC8C42A5DFE23CE3F554210A18C43BF73F5B09F05BE90394676CFCD28F62D8FF65387C2D19C787050E5B04517498763CAB882777E187000ACD1FE409BEBCB95AA438FDC0628C10CFC54889A96BC3F921787DCCFD0653E55B45AEBC15E3D85A90846671CCB850CBA7CBD08DF4FCC3AC8F0751F42A3E3B234C011B472E96EC86A48353D2E63356A0F2713E0C7C5C5A6E093A3F86AF9DCC768A5C6DA9040242CE9B9C3F29859C80953102DC8095DA177AE37ACA55EDD94A929768A954DA3CEE24B7DBD296972FDEE49AFE8647B1ACA230A1C8A17782409012BC4EDFFB6BFB551BCB7A089CB2E357D65961110526DB1F2180C26D4A4DCA3CB7E5C47D1A0B93B62D07F4131FF13CB18A59836EB615D057BE5D91276089BBF28C562994C12CFAF0FB69DD158CF4EC7A45D14ED1C4976103D74EB2FBF415F603A53C23730BABB6B420616BBAE2DB954BB4BB6EDB8A6A4B455D7CEC97220F99B6D8790482573226B2C4628D99FDE7049703E7B925287FBF45492A0F3162155B94D63767BA24B7BDE74820A83277571ED45546B285DDC112BC7FB4CB22D5C55A7976158FBC2D2417EBE0B024C5DAE6705246B9B24CF247C9AD60486EA305EF6E95AD47813076AE7142F2A6600FB73902B3A3E06980F70F2DA8DC0D0A4B532B8ADA5375AF65D89AD69381A023774DDED1CDCB56CB3148F3E066F74A433363D0CFEEAF7E5935C07BCEB42167111B68B567616631B6AF66F1FC21EF35F60E48AD348C82FC25BF927C48D1D03128FFC7FEAC0820F4B3B0E0DF662B2D0AFA223C70DED44FD59C181EF14B1343FBD7962CBF77AF0D00BC214C3D9E65E8CBA26BD72661863CB48218DD1231F6E803001AFDFBD392C96C2674FECF1EFA075D4C851295E6E481D078C4054C5727229DD07644AB9B80635F08A7077FF3B8229E52D915F0596E431147ABA1BF59F8CCAC57DEB841C2CF2A20A2EC289ADF19404A951A6C80BED49CE71FBF46CFAD1CF521108FC70EA7A61DC077BEAC9995B1FE9357FFF0BBB36BC8E0CEBD23C38EFB0C0658A735C6067DA8C9F0499B1874882EFCD8189E7AF8B7B64E0E21BBBEC767F07F313A00ABC638C548E40BB0F3C78803A0294C711548BA725C7D154B93C3E0ED24BF4A6C27D8C18535D8AA356DD8937A4FC9E5CAC9053A225B5E9079F27250CD2D9950AFA55F77824AA894B1517F88A41E16CB48FF5229E543DC42CBA14003EB395B80FA507D838BBD2AC24FB0DC4A5ABF461ED50DF90D632C926819F9B3582F593EFC96E0179B9831B8652268F9DD4E9EFE022917679817B484BAC4385B81A98D2C04F627E5E7F27D60AC7DA9039DA79273FE930ABB0FF785CF57C24785D988684D2ADE392C98CB61DEC541836FCACE57519963029A911BB1CB07F9F9D82DB3D18679B4898708AE91C46D107DBA384ABF827E793F55FCA896287BF9DB607B25CED2A70224D558F9FAC1695438361429E6E633D6A1D79AFCEAAB5E188EAC7C6202C2C572B7EFDCE2439C0EDB3F69A0406E6B62F794BEE8448A82756C27999303D3C211BB8A1CB5D63DC9F6180A166589AEA45C144E8F5525F32F190B34C083DF993B8F4579EDEAC13C5A5E17E2950C8E0081EAE8113990209EAA8A62EBC0F520A6F1B85E356E662B882CA54D18D46A4E78C03E76E7F662AF80BE5647F7D5DAA1C55CFCB01BC36DE17EFFF344D93D0564C57E18410AE72F846C5AFC9C95BB0DDEE698FF664216F2E6344B190CFA8E8B7378046FF28FBDCC0E6AD8520C090D4FF4A2497510482783347331CF7EE79ADE41AA506A8E022929432F0C150FB1E8493C4F9B20F7EA6335DE695B1BDB5C8B0EB6849EE949D1A5375393E5759CC99976BCAAD05EF00C7935734EAF696BB46A8CABDB34A6F5E1EF142D0136E56B67FA3B95C6E120DCD1FAAA19BBD152B1864A06A8758FFE0EE71E059E53CA541EA2679C3BDD9B764C4736C69F94ED69C2CE81B781376A604F708562D48A7101F614ABA9DE252AA0232ABB19746FEC364946C346785B5ED8BDE644A8325D461B85B05D3DDFC779DCE3E4FB0988246F64E346D03E1FA292058B58CB9FAAE4F198CDEE7C90BBB14428A71466CB2E292B976845BF76F4B520955ACC9F51D62D5D276ED5A30126AE85B2C9FF86275CCCFEEE6ECDF32323831C517F21901C4E18C5B6156B5B78C944600EFF40303A6FEF27DCB12711F0CCC40820B07427672F799436CFD83FF17349D00BF41D2649621C3D63A1F1601BE8F4721F7CD99A95FE9D624649179C48585486F91ADF4FBE5B967851AAFED36E6169CED2861192977E97F0193F64FE2BBD03824F59F63D22D217BF46F7EB64189CC86CD7EE6866B1ACE0F44D69E75F5EFD35C955A8725878EB056A75E414F368155A16003190597BA7A81A345C205EB3D44BA167F88FE9FB2ED1EE7C10BE5943A2D968CE32CB7F54DC3BF7504852181738DAD916F47CA7CD0A30D76F08D8856D8DBD8341ECE2942C189158BAAD8A681BF0B48C44FACB6DE50FAF5F38CCCB1C024BA20DACFF2E98318C66F9FC22FE42894890005C03B24CCDE21BFDFD2CFE92B7E259857C8582AC81479F8ED74AB298F63A9C9B7A46F31BEB09E75D56B2D7BA478E941EEF4694817C5C9E0A7C9B08EE7DB7112597B1D791F772986B2B74EF1A8832951416568CEFE71319DA8529ADAF3C596AFAA6D7180C8E3C6288BB72F88112CBE0ABF859F2CACCDCE75F2D08F66D9C3BB963FB6128CA9B78550592208E952A376D29CE3D08D702EBCA2F8DC6D29FF96B1895883462BE162F18055888BDA15BF2DA91FBD0BAD7F9DC63670F58C8306E8A9F60C10B04B476E315622188DA83CFFED2E06D6A70B9852482F388C84E417672CF2D46A50AEE016C2EFDD0030769F342F0635A288AEB81787EECC0486DAC1F0B9053D25C6C896CF97F4533F130B592ED52CE46E207B49606F9510A3D5BA10937690524424192DB5116E6556515BB3BD3DE764D1384691552806CE0A801F71774BA41B96500A3635A27C127CC005F616BD3CD8AEEC972511C8D70F010D4047C868EC1976F24CEAF8BECA4450F1FC4A89CA7F5987FE629A544AF7C3947F86A6F19FDB9E53304ACB158BC70D6CD36BD2388DB4CEA2665E1C53F6C5E32A47F00421363D4C5D64657C8B8E989AB6B9CBF708171A4C707D858B8FA9CCCEDDE7EBECFE0D224C83848EA0E3F2F4F6FD263D5159989CA0C4DBE000000000000000000000000000000000000000000000000011222E3822C7A5C14496DA10364EE1074551526B9EFAFB490FA5DFE449B487E4B43B5BD1D1EE4F0AFBB781AFD2C746E2E567204B9DF506AD9815CFDBB98576F8D75129B8B80C02D6F0CB56A10AFDA646296A0320B9A304941BF739F0C61F46F537EF9295BDAFD3862F65BCCDDFB6DFE33843757B63BEFFDDDB54F2408104BB6D91DCDEA7FDE58A6174ED7F0338F8F321DFFE483282951C1329276E0F6138F55674A300EA9A4AADE434211EE4543CD21D336C4BA6FE0870EE3FDD8CBCFE7F69119D731E88BCAE574D62628EF74BD628BEBFD9AE11FFA550D0BCDBCAE4F998EC7248CBBED1D8014FFCA9C2F9F18B87A7DB1AF59069000FC981D58650EAA58E7FFB47CA26AA29C4AB3AF4B3C9A486E0468195C62CC300B68BA80C7B751E1B4594C3D2C4BF76096A8DC60EE035A67C7806BD735A090A9E5E65DDF42A35C7A4446B369B45CEED9BA6C873480B2562009215F25CB75A2943BE9607F787B539E67A8C3FA5618DDD154DCD828B2EEFA8A8EF65933FA6DE706939CEC85F3923B6CD20E61553D4BA595F53D924E6B382FB16F1073267FCAEFFD1A0E59ED2B65394716A96DF3406EB868444E4C09223757216564805EF74D2FCE8A2A345D555393CB818EE77CA1D02807AC2D00D8943319CEB22FF17552241746D9F49DAF2384D11EF2E214FE6747A621620D93F6FE3358D41308F2EC823C0386F35A45FEB6DF84888529CA78DFDAFB97A84797F69EB6F7AA4A1FD859F57688D729E819E6B91280CA04CF1631207D51E93DCC72B811A237FED8C62820132132F5530BB199F703EECC176207877DE3FEC92C1B1F5C55FB12EF54448A9DFFC0ACE9E1EECA3973993DE15BF472D9D09E801C96BBA91EF1695A79FE0DF7A83F7ADEE37FBF5EF59B0B46189E648FA0A6023E95C96407B0098D0B4DD88D7B00BEE5A74E7847B82BAD6B6CD9FCDC125A17503D9C00D8DC8DCFD7A37DB3A02F39A5A1438BF80B7767FA436FDAC80638E6BAFB65FBDAA437353C7DD3318AA49D8E66BDDF75F9FCB86C45A979E38490390227C4D40BAADDE814F3CA5B10A8D6D0E68B5F8BA671476AD87D4547C4EF92F0C642CF368C5AFD34C05ED1D819C12C48BDAA3D349FF5896BAEC9321198E7CD727C08B2F094D896099D641259D5F59F5BBF7D75813D243C81478796F1ED60FDEEA73A514B2A8DFD2A686D614B1F6E4256D3204FCE1C543B8BE8781044C30F7EF9E154743D794866756D360421F31F6900D78355F4AD08FA52EDB8A010AFF669DD0803C1FA2074AABCC27C354CCE0BAC0875D08FED9E16A5F1B4AEF9F7C7C7E6FC943D46DDC74B23D57DBC4701EF7290A0932737DD01C10AAFA02BD7FE8D1E9CA7FF6F013790B8A1F5B9AFFA32F22990749864D1787B78C9D22541B898B3E774E78A97DE3DF49EC041D565BA6DB4EB95B255F0829D60CFDF232F1F3E9B3FE6E5474857BCA10ED73675197ECEE3AF08EE432EC6B6A508DF54EE3F49BE0276CF155C40F26175D2AC9285A2307A3F798C69B7920C6918365262C7A2E3ED553056E1F90CFC30189B680FA06BE1873AE511138E404681905B7B4168B78EDA53746BE06C2E2A9949A2F22D505BE2A6D02E8B42626B13E446C1C5015FC31740A841F8E7241FDB20473FC6402D322F3B12466612B8733321EA3C961A136DA618A9F71AC876BB5EC7D191535C9D7A44533C7826D6158B94B2C5D399BC47E6DB6335E6BDD3F79C47F2B6A52BB7E3C05800C34F660ECF097F1942137A34B08880F5A69C217BD1478360F9E8798DE4A22FEC804152ACAE3580D1C94594CFE9DD5E8E2014C084B62C664443F708EAE266B6A57305C0FA11C6B689780503D64C6AF86EA1E0C8827CDE8CB79965313E9D0F877EC78D2FA193CE8AFA7D6BD20AF1D33C8E6E88424A13127EB16053D5667C6B3532240D4C3F6601AD99B8BA49DDD59AC2EE2D03634BF0C67EAEC338301B44423B23847EA3B50B87A98759BCD94F40E97A086FA95AC7A45368BED8AD529CEF9E1A12843EE1398B6E0219099203B77B19029C8BF3A03FC9D3E501D9A68936E08AF7E48BEDC5F9E5BE3DD68BB13040391E2ABB5083508B3FBDB091CD4439A75FFDA5168617E0FFE090120632E12D329471F2E4358760B3739EC4D5D76AB8238DBCF6B83D2D0C31093C8A8C42278AE4015CFAB40236CF0575CD74C41B66E796706C4D18C22E2B2CEB7220D250E680E716CDE00E880FC8B8DADF139FA8865C9F0895A5BAFB71889C819DFF358A15757FF27D8693792D4530445BCBB890CB3884EC07D8D9472DE72A3EA636541EFE8413AFE2C8B99A42C13220AA6FDAC83C4BE1D691DFBA5C71CC80C4061669B7EAB79742B09D33409262C940E57D5DB0C12CAB5FE2779260BB0F40439243B07A44388CCFAB7CAB4F94030753703A1BC4B1C5B7487AA5B537C47ED2F9772536430D7853BD1EFE3DECF2A5F59DDB2722C3BAC7473F99595275C9CBA5D67E326FE09F6908D5D0A3ACA73193110493CA1332DDA102A0440C369759DDE6FB61CE52F76A2B5D66C6B5BEDC07D4CE028B8FFA5A50C604F0E65F48635CC723C69D286A5B9966A9F3D1F9400D190749F21FC16D17BF59AA0993CE82D2D2056D54DD8BA58AD7926A7A7694C0D982B958527EC33B975EF872525F135ED21F92D2B9EE386E378180CF959DC155DEB7FCC5753931C3121C6894B577D712687591B06DC3F74C740CE270D05667C343CF2B4F1BA822CD32464AEDBF682E519E5E23CB5944425368CC382ABDBBCACDD8343335A8AE11597263CCE9B3EEA44C7FA00E98468F6482761D2514670B4633263E53C94596852023EF5954663F18D91EEA32F1C49D5D12175957A39632A7DDF446A7E5288E9C2B3398B80AF9B6E4D72A7AF3D7D5ED2E254BA1EB0DF899364784293BC2324FE7FAE85CC5B149E2E03DC73312C696EEE93A0B502D87502991B50B5529AEECFD0F59952CCAD69229DA92D2DEC9D180271D4C8D8E1522519559A0B7C061877CD2C77AE21302B682A4AFC7E9D60ADA723D29A2A558DA041ABB03D2E9BD338E82C2EA852859A63FAF28D6952CB38606324D253ADBA40CE1ADCD6FC30E8FA252D7608A74106C1CC4F1893BAAF4F00499450E6653691914B5AEB8A3635F09F2B4AFE10F0BEEE700087E6D8BAFDB93822F5F4B8A769568BA148D6600FE9D91BC5792063B301835A2C53B28A69CFB0B7FB1A9608A0E80EB5BC3D9BD64466D27D3FF1CD6C55D6C3924A6F2CD4CA9F5EC9749841487A3B81190AF086DFE25C7438146B1897470845DEA729FB76DDD363FA53B8B953D7153F38E0874CC6B4CB63FEE777EEF750A291CEB110254BEA46F06C819DB991432DB21B8C50E6DC03B839D5F99A88FAB0F111C9CA73DFBBD66B27A242D3299AA349862EFDE0FCD54E1FD4BDACC2F2B0470003CBA7F4D241B5A88E84594DC716274086C05AB5F2C790554752ACAE95AE2BCB177D5F3CBA3DDCBB867C4D641FE3CDB97BF88DD931BB0C710848AD50CDC373BB9B343164E0EDAE6686086332A2AD3CFFDF96EB37C49474FE476453351B11AB4E487CEA6F4456D86D6B71D74E7D72D9347A73F7D1C6E6AF918FEB9793A1FF5A73B4409CABD1D55CFE58D008488684C63E824C9E8140DA6F5492C146C05F6D2F7B4AA5632D159BFFE5013C7403BCCDF3686432BA47980346094B40C059AD34E90C9CA0EFA7161A8086DE8ED91882D3E48CBE1F342F79E1BF0F2A34B5E7876267B6A75C4AA7DC635B7487BA1653F9DCAFB4E9E7D425845C5274F0112043E1DA427D913C7D55F1704ABF379A14FCC6714C9BCB1EB3EC05CB7C705F05947CF9819E257874C9A4DE01F28AC14941238C7FF6204FE383906E1AEE10689F88DEFCB5F64921A4A383503CF9BFB9E2E180E886E962963FA5A25B4A80A7A176BAADF4242CADA006031D6676B9F1E9C87218207A9DBDC755A22AA92E705C099EFE3BCA49E1418FE8EBEA24C9D58493B4E5979D37A0DC6944060B2D14CA60358A3E52908360E4A4ABD7A99A844865E0D2C589F52A22FE4042E423FED5C023F8A1E724B5300263CA98CB9193CBEAAEF9BC21D7AE87D533121A8DCA725203CDFC3F22A8C44497B453633DBD9720AD1E0A3250C071B7A80730609011CBBAF253BE747DF1EDA729B1C565A7D6EEEFCDA8BA011E04E2688E8878244759B0158A2D943CA45824F1A279B265CB05B91A114076452AAED4FD0B3A5448F247C95EBD151763CFA096F82DDF68EA1726970A172DC37A66D52AB3987CD7BAE7E15EF0D57B1AB3BDE97BDAF2AF01B84E11B08E556619837ACFB5B7D5332E748FDDF18D7619C58CF46342CDCC9FB7ECF74C688E0E6747B9E6200C6A834737CBBCFFB594AA3E11EDBB423499B52421B599E3B0D4D619E4AECEA77EBCB1509BF032503413B69EC2EFC5D0516FC028624D88AE686ED9A6EC3EB511DB9194B222C0BE8057D69FAE2D090121686D2D62E64234B1BD30347093A30AC287D8FEB37443A4DE49CC1289602EA6151B7D6349D17991366BF75E390EB5C83AA1CADF4B6B2E28168BBB8FE88097BE1A7BF318E6F8698D0E6C30DDE9878699E3730DDB167F1012DC7EB3FF8ECDE73231953DFB6A6989A1E5A02F152DCCE9E5E7EDA427F0ABA6F97CE468EF13E462AC64919DFB09A7BFE3CA363A79FEA9ACFDF76103722645BEC5477F9742C4E785348FCFF52CAE861FBDBCC6A72F706317C04BD3D04DE895120577797932511F2E4F9D3235842E1834C7911200CD1E04ED81EAE5F3D819B0AA74D4769CDA78C0F6D403B9C4E46E7E665506BCBAE0113D98FC8748F968612557459098EFAAA05F31661507AC864DFCC2CC7A7828B6538F56403C133CA9EF57C7C030C1DA8CFB981DD697FD73346115063329B9DABFB7C386590046FCAD240DFBEA4936DF4937C855CB594FFAA8AFB716AA8AC4FE784B6A5E572C0E43FB2015FD64B999259B487E0F220AC8F88280828A405C1FAB1116EC815759AAB090FBE5F582F406F8F73B2E61445171A7504612C2A49BAB4007BAA432F7F07970C379A0B3A4677A85E626FA9957AFE5426199E3130254916C847AC86C762B0E034184C4C6F2BB64DED9317B2EBBDE172B86AE50D369FE3CD7723A23A01B986F125646E363D7C2119B4E5F4A7871E025F0ABE896987A9294C285EAEC3C9090A6DCCF8BC320B01F472F6C14DFC404567BBEC194B842D1BCF15951B5BB7157990D186E2FFF4F55F7EA33EEC607F4E305EA81D36C6DB248EB035AD914ABCD5D3762897B7B2BC3ED6AEFC46AD91652958D3BBA27A0E3076098D2C4B6754684A449C4391B48E6D27B49C0E2FE49481192C11646994D9540CEF51DDD3CC1BEEB22B7763C5EB57A42F940CFB1E66B47D358894ED7DF30D32B10B9FEEDE8791860ABD241071F4D373F60A903E0DD02CFD9A4D88652F67C5010CEFAB927577851E49F41FB57EDF356D84B772FA7AB4CE3715A75F0375699E2B2EF78B252E0F4E413E0552D275DB8B8F6A363C82F8CBB6ADFD93650B50C2DF78D249BDC1DADFA843015244BAE242E3D42636995DE01223E445C8AB1D2E2E4F30D3075889AB0BABCD2DEFE05093343464A5D6C8082848E9EA8B7BDD9DDE9EBECF9FEFF00000000000000000000000000000000000000000000000000000007121D3593FB956306E33AB6326A0C5FC29E470685223A6364777A5A7621C346C37138610FDFFD8015185CE2D2C746E2E567204B9DF506AD9815CFDBB98576F8D75129B8B80C02D6F0CB56A1F136187F00D80F406269E5DB220CA97A20288F249C6F40F0CE380748EAA8AF1EF54EA3BBF9748FF575892762826C845867A76CAAE8688808FB8743563CCEA914DA2389475BD738EAF5E797F1674AAC25DBD61BE62DE66BB8D29729AF2FC59CB357AC01A739394280DBD626788B650A1B780AD3C9BF8AA413CC489836BAC86BB12B8C88102EED42B2E644B1C05C99E63E228C7A097C48033695D3D9920A1DB480E7F932CFC9AD3B26983CAEE76EDB1E64F88B93C02A6BF4F68B80F533B703057C8F77BB90FB407BF43DDE23DAC834BAF4F2DA28BDF3151B0BB5738DD27DA2C9D097C9D24C13A46871E9254A5CE9D41328B5CE0247060EBD34B9D17B559CFA5F7088B5A6FF29A6D7D9FAAF10D25C25AC8C8D810E34763BA6EEF5C37B4BE1F72080F5A10357252690E217D5637EDE1086A464A3D540096D598FB78502020FE1EB3FD23CAC97B8B44C160BB61452745EE71877A240D7EEA540BBC186959D0074EEAF5FD2CD98600048E6B677018745AC31ABC8E9CD50E612E98BD1C5B16BD45B2922B38523CB1882C5FEDE29032E2BD21E409CE51299D117367F45E95FF2EE785F41CC80935FAE16F6B971758C7D04D36CDDF5B35CA28597ED1CA040D6789B9A5A67A6E5D9969E2EC1B9AFCA7A02A845956A514E8F362258EA6DCA6761EE84D1DA5ED59C56581371003795263622327AD9A416585E051EAE398855DA6B4688FEF00E07841F4D8C9250DB2F3DA0D21771E9011BF1BE5D5D4F2BB63B83ABE4BD4F20E0CF8A18CF8CB0C19D494F6FC99F362E2B926040BF873E3EB81AD5BD6160AEF6978A5F6BB691E2583F7848C12CFE180E1D5B79458DE1A24F362D9AB73DDB609F7895F887FD121F7994B118815A65E840C061C93CF61ED5E2C4909E3C8824BA0D8AA060FA36C3EC53203ADE38A7FE66992147AA7D4F0FBC7821CF08DD60507B5CF1F61425D9E8899231A94AE512169074CBE6574B7E54286439F982E956C09054D194100AEB0FD50EE8FEB627F90B1BDDD463674E80C894E57F8095093774F43B37F085CAAA3160CEB8CA2DC696BAAAB5D554DFF41CCEB1471B994208A2B2F09D4F685CC1147CA28D6AD3771C1D1C551DD193CA4FCD3A9E8208D0873A861C953E78A0D60C3B32F1A99B3C9152540F449EC4D5BA53AAAD424469F2D9089F109A436EA90237158BE83C81C0DC10B530F5AB23F2C8D11FD9C6394B397799EDB309C76A7B6C88570D6C4D80E3C63DDFCB8C7EC5FD11A109A659EF7DF10CEC618BE92E363BFE008ECD118B85175E91E1EE8026ECF02BD67AA06B258F9D304D707896E299894C1751CC6E3B9B110B86EACAEBE5D8BDAED9C107D6C929B48181E094C3CBF2EE101193DA837CF7F922363B4B7E37B0846DE0905C0B817E4901B15F44B34103D018D293270D60B2B8FD8F1596DB992779B8263E18E967C3047EFF94651BE6D52AA1FD9631EA3BCA46D3E1B8382756C28987194430C653A8FC824EBD5977392FFB8F46B3CE73EA74AD4829F12D3BA2069BADCE7AAD1D7D28601768F6B5A6DF4160278D187D696A13EB42C85A1FE684D7F10BC0E44B6F4AA2E6281C3DFC33A8A9757A2BE900CB38B22462CABEA4D1653FC22726D5F92F0AD26790848E743869D865CC207D49D6E4790743CA9FD9AEC62F9373E2A2AFB5DA70FBAD5B96369F85340C3F0190EF1C4540E164A9675CFA0BD9C818A8FCB445CBB29A42B7226916978F811B0855485CEC8D22255C59181165AE04973B5BB095BAD13FF79D9D1E98E1957C416AE4953050E3C9757EA56959D9E673B7503F6A01CFDE9DD9EEA22A5595E8DEBD8BE5C7AE49953BE60533F29680999B79ABDE91320D4740CADDBE6D91DCD39F3D8D487A63BEAD34FAC559C200DC42180C177A36119E3C5B734D6A16481D02AC0203BC23E746A47D088B5119CB28952111424FF7F415183EA6018545EAE51BEE1F76F48C43EFED1FA26C7401503992DA45E2AB7490AD28EF5C7099A05D5A34",
		EthereumSignature: "0x7db87742f8ba5d7ed978d4a290ed11e05f285e223b1a7ea4aada5dabe0c38c2005b4079d8f59d0cbc59137b069257e6b92cabdb57bca90e9a3e4e48e7479c4dc1b",
	}

	//Ethereum signature from https://app.mycrypto.com/sign-message
	//ethPrivateKey := "a09d9a0c4b3cfc7a524a47e9cb6760f8c771ca0c9d83f6624026ac64b6347641

	_, err := VerifyGenesis(details)
	if err != nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}
}

func TestGenesisValidatorStatic_Negative(t *testing.T) {
	details := &GenesisCrossSignDetails{
		EthAddress:        "0xbC22f18344B750Cc46F37375ed7fb607b9C649cc",
		DepositorAddress:  "0xeD303665Bf738C649Be0449146C2a3a06BF16fcd291f27F7e6238F3b6eAa1eDB",
		ValidatorAddress:  "0xCA35916aE38F1457b3cf72D70dAFBda203AC3a6f441fD8cc875F1724D6a63933",
		Amount:            "5000000",
		Message:           "I AGREE TO BECOME A GENESIS VALIDATOR FOR MAINNET. MY ETH ADDRESS IS 0xbC22f18344B750Cc46F37375ed7fb607b9C649cc. MY CORRESPONDING DEPOSITOR QUANTUM ADDRESS IS 0xeD303665Bf738C649Be0449146C2a3a06BF16fcd291f27F7e6238F3b6eAa1eDB AND VALIDATOR QUANTUM ADDRESS IS 0xCA35916aE38F1457b3cf72D70dAFBda203AC3a6f441fD8cc875F1724D6a63933. VALIDATOR AMOUNT IS 5000000 DOGEP.",
		QuantumSignature:  "041F820F7E0FFE090120DB5F0149D4FB6654E983C0FCA62D1B34C66BC1E59A82A0E379B1435D39CADDDF845701FDBA86374F14736BCFB2718CC99A0D3C068DB2F401DC82233610171B04C0AE600D4298DB18DFD5E1F0C7FBFC724F60885AE93F320D303D6E944061A55373E94338BA427C638DFD540AEA30A43E2DA83E99802F2C6F07DF2956B1E28C56717C64BEF7362D6016FEFB42D4E25BCCA926F9623F76F4D9573204AE053B7B9BC23AC54E23F6E7E39EEE7B0F3E27569A9CD25EE39882E62860E87E7465A98ACD30C30BFFC8C42A5DFE23CE3F554210A18C43BF73F5B09F05BE90394676CFCD28F62D8FF65387C2D19C787050E5B04517498763CAB882777E187000ACD1FE409BEBCB95AA438FDC0628C10CFC54889A96BC3F921787DCCFD0653E55B45AEBC15E3D85A90846671CCB850CBA7CBD08DF4FCC3AC8F0751F42A3E3B234C011B472E96EC86A48353D2E63356A0F2713E0C7C5C5A6E093A3F86AF9DCC768A5C6DA9040242CE9B9C3F29859C80953102DC8095DA177AE37ACA55EDD94A929768A954DA3CEE24B7DBD296972FDEE49AFE8647B1ACA230A1C8A17782409012BC4EDFFB6BFB551BCB7A089CB2E357D65961110526DB1F2180C26D4A4DCA3CB7E5C47D1A0B93B62D07F4131FF13CB18A59836EB615D057BE5D91276089BBF28C562994C12CFAF0FB69DD158CF4EC7A45D14ED1C4976103D74EB2FBF415F603A53C23730BABB6B420616BBAE2DB954BB4BB6EDB8A6A4B455D7CEC97220F99B6D8790482573226B2C4628D99FDE7049703E7B925287FBF45492A0F3162155B94D63767BA24B7BDE74820A83277571ED45546B285DDC112BC7FB4CB22D5C55A7976158FBC2D2417EBE0B024C5DAE6705246B9B24CF247C9AD60486EA305EF6E95AD47813076AE7142F2A6600FB73902B3A3E06980F70F2DA8DC0D0A4B532B8ADA5375AF65D89AD69381A023774DDED1CDCB56CB3148F3E066F74A433363D0CFEEAF7E5935C07BCEB42167111B68B567616631B6AF66F1FC21EF35F60E48AD348C82FC25BF927C48D1D03128FFC7FEAC0820F4B3B0E0DF662B2D0AFA223C70DED44FD59C181EF14B1343FBD7962CBF77AF0D00BC214C3D9E65E8CBA26BD72661863CB48218DD1231F6E803001AFDFBD392C96C2674FECF1EFA075D4C851295E6E481D078C4054C5727229DD07644AB9B80635F08A7077FF3B8229E52D915F0596E431147ABA1BF59F8CCAC57DEB841C2CF2A20A2EC289ADF19404A951A6C80BED49CE71FBF46CFAD1CF521108FC70EA7A61DC077BEAC9995B1FE9357FFF0BBB36BC8E0CEBD23C38EFB0C0658A735C6067DA8C9F0499B1874882EFCD8189E7AF8B7B64E0E21BBBEC767F07F313A00ABC638C548E40BB0F3C78803A0294C711548BA725C7D154B93C3E0ED24BF4A6C27D8C18535D8AA356DD8937A4FC9E5CAC9053A225B5E9079F27250CD2D9950AFA55F77824AA894B1517F88A41E16CB48FF5229E543DC42CBA14003EB395B80FA507D838BBD2AC24FB0DC4A5ABF461ED50DF90D632C926819F9B3582F593EFC96E0179B9831B8652268F9DD4E9EFE022917679817B484BAC4385B81A98D2C04F627E5E7F27D60AC7DA9039DA79273FE930ABB0FF785CF57C24785D988684D2ADE392C98CB61DEC541836FCACE57519963029A911BB1CB07F9F9D82DB3D18679B4898708AE91C46D107DBA384ABF827E793F55FCA896287BF9DB607B25CED2A70224D558F9FAC1695438361429E6E633D6A1D79AFCEAAB5E188EAC7C6202C2C572B7EFDCE2439C0EDB3F69A0406E6B62F794BEE8448A82756C27999303D3C211BB8A1CB5D63DC9F6180A166589AEA45C144E8F5525F32F190B34C083DF993B8F4579EDEAC13C5A5E17E2950C8E0081EAE8113990209EAA8A62EBC0F520A6F1B85E356E662B882CA54D18D46A4E78C03E76E7F662AF80BE5647F7D5DAA1C55CFCB01BC36DE17EFFF344D93D0564C57E18410AE72F846C5AFC9C95BB0DDEE698FF664216F2E6344B190CFA8E8B7378046FF28FBDCC0E6AD8520C090D4FF4A2497510482783347331CF7EE79ADE41AA506A8E022929432F0C150FB1E8493C4F9B20F7EA6335DE695B1BDB5C8B0EB6849EE949D1A5375393E5759CC99976BCAAD05EF00C7935734EAF696BB46A8CABDB34A6F5E1EF142D0136E56B67FA3B95C6E120DCD1FAAA19BBD152B1864A06A8758FFE0EE71E059E53CA541EA2679C3BDD9B764C4736C69F94ED69C2CE81B781376A604F708562D48A7101F614ABA9DE252AA0232ABB19746FEC364946C346785B5ED8BDE644A8325D461B85B05D3DDFC779DCE3E4FB0988246F64E346D03E1FA292058B58CB9FAAE4F198CDEE7C90BBB14428A71466CB2E292B976845BF76F4B520955ACC9F51D62D5D276ED5A30126AE85B2C9FF86275CCCFEEE6ECDF32323831C517F21901C4E18C5B6156B5B78C944600EFF40303A6FEF27DCB12711F0CCC40820B07427672F799436CFD83FF17349D00BF41D2649621C3D63A1F1601BE8F4721F7CD99A95FE9D624649179C48585486F91ADF4FBE5B967851AAFED36E6169CED2861192977E97F0193F64FE2BBD03824F59F63D22D217BF46F7EB64189CC86CD7EE6866B1ACE0F44D69E75F5EFD35C955A8725878EB056A75E414F368155A16003190597BA7A81A345C205EB3D44BA167F88FE9FB2ED1EE7C10BE5943A2D968CE32CB7F54DC3BF7504852181738DAD916F47CA7CD0A30D76F08D8856D8DBD8341ECE2942C189158BAAD8A681BF0B48C44FACB6DE50FAF5F38CCCB1C024BA20DACFF2E98318C66F9FC22FE42894890005C03B24CCDE21BFDFD2CFE92B7E259857C8582AC81479F8ED74AB298F63A9C9B7A46F31BEB09E75D56B2D7BA478E941EEF4694817C5C9E0A7C9B08EE7DB7112597B1D791F772986B2B74EF1A8832951416568CEFE71319DA8529ADAF3C596AFAA6D7180C8E3C6288BB72F88112CBE0ABF859F2CACCDCE75F2D08F66D9C3BB963FB6128CA9B78550592208E952A376D29CE3D08D702EBCA2F8DC6D29FF96B1895883462BE162F18055888BDA15BF2DA91FBD0BAD7F9DC63670F58C8306E8A9F60C10B04B476E315622188DA83CFFED2E06D6A70B9852482F388C84E417672CF2D46A50AEE016C2EFDD0030769F342F0635A288AEB81787EECC0486DAC1F0B9053D25C6C896CF97F4533F130B592ED52CE46E207B49606F9510A3D5BA10937690524424192DB5116E6556515BB3BD3DE764D1384691552806CE0A801F71774BA41B96500A3635A27C127CC005F616BD3CD8AEEC972511C8D70F010D4047C868EC1976F24CEAF8BECA4450F1FC4A89CA7F5987FE629A544AF7C3947F86A6F19FDB9E53304ACB158BC70D6CD36BD2388DB4CEA2665E1C53F6C5E32A47F00421363D4C5D64657C8B8E989AB6B9CBF708171A4C707D858B8FA9CCCEDDE7EBECFE0D224C83848EA0E3F2F4F6FD263D5159989CA0C4DBE000000000000000000000000000000000000000000000000011222E3822C7A5C14496DA10364EE1074551526B9EFAFB490FA5DFE449B487E4B43B5BD1D1EE4F0AFBB781AFD2C746E2E567204B9DF506AD9815CFDBB98576F8D75129B8B80C02D6F0CB56A10AFDA646296A0320B9A304941BF739F0C61F46F537EF9295BDAFD3862F65BCCDDFB6DFE33843757B63BEFFDDDB54F2408104BB6D91DCDEA7FDE58A6174ED7F0338F8F321DFFE483282951C1329276E0F6138F55674A300EA9A4AADE434211EE4543CD21D336C4BA6FE0870EE3FDD8CBCFE7F69119D731E88BCAE574D62628EF74BD628BEBFD9AE11FFA550D0BCDBCAE4F998EC7248CBBED1D8014FFCA9C2F9F18B87A7DB1AF59069000FC981D58650EAA58E7FFB47CA26AA29C4AB3AF4B3C9A486E0468195C62CC300B68BA80C7B751E1B4594C3D2C4BF76096A8DC60EE035A67C7806BD735A090A9E5E65DDF42A35C7A4446B369B45CEED9BA6C873480B2562009215F25CB75A2943BE9607F787B539E67A8C3FA5618DDD154DCD828B2EEFA8A8EF65933FA6DE706939CEC85F3923B6CD20E61553D4BA595F53D924E6B382FB16F1073267FCAEFFD1A0E59ED2B65394716A96DF3406EB868444E4C09223757216564805EF74D2FCE8A2A345D555393CB818EE77CA1D02807AC2D00D8943319CEB22FF17552241746D9F49DAF2384D11EF2E214FE6747A621620D93F6FE3358D41308F2EC823C0386F35A45FEB6DF84888529CA78DFDAFB97A84797F69EB6F7AA4A1FD859F57688D729E819E6B91280CA04CF1631207D51E93DCC72B811A237FED8C62820132132F5530BB199F703EECC176207877DE3FEC92C1B1F5C55FB12EF54448A9DFFC0ACE9E1EECA3973993DE15BF472D9D09E801C96BBA91EF1695A79FE0DF7A83F7ADEE37FBF5EF59B0B46189E648FA0A6023E95C96407B0098D0B4DD88D7B00BEE5A74E7847B82BAD6B6CD9FCDC125A17503D9C00D8DC8DCFD7A37DB3A02F39A5A1438BF80B7767FA436FDAC80638E6BAFB65FBDAA437353C7DD3318AA49D8E66BDDF75F9FCB86C45A979E38490390227C4D40BAADDE814F3CA5B10A8D6D0E68B5F8BA671476AD87D4547C4EF92F0C642CF368C5AFD34C05ED1D819C12C48BDAA3D349FF5896BAEC9321198E7CD727C08B2F094D896099D641259D5F59F5BBF7D75813D243C81478796F1ED60FDEEA73A514B2A8DFD2A686D614B1F6E4256D3204FCE1C543B8BE8781044C30F7EF9E154743D794866756D360421F31F6900D78355F4AD08FA52EDB8A010AFF669DD0803C1FA2074AABCC27C354CCE0BAC0875D08FED9E16A5F1B4AEF9F7C7C7E6FC943D46DDC74B23D57DBC4701EF7290A0932737DD01C10AAFA02BD7FE8D1E9CA7FF6F013790B8A1F5B9AFFA32F22990749864D1787B78C9D22541B898B3E774E78A97DE3DF49EC041D565BA6DB4EB95B255F0829D60CFDF232F1F3E9B3FE6E5474857BCA10ED73675197ECEE3AF08EE432EC6B6A508DF54EE3F49BE0276CF155C40F26175D2AC9285A2307A3F798C69B7920C6918365262C7A2E3ED553056E1F90CFC30189B680FA06BE1873AE511138E404681905B7B4168B78EDA53746BE06C2E2A9949A2F22D505BE2A6D02E8B42626B13E446C1C5015FC31740A841F8E7241FDB20473FC6402D322F3B12466612B8733321EA3C961A136DA618A9F71AC876BB5EC7D191535C9D7A44533C7826D6158B94B2C5D399BC47E6DB6335E6BDD3F79C47F2B6A52BB7E3C05800C34F660ECF097F1942137A34B08880F5A69C217BD1478360F9E8798DE4A22FEC804152ACAE3580D1C94594CFE9DD5E8E2014C084B62C664443F708EAE266B6A57305C0FA11C6B689780503D64C6AF86EA1E0C8827CDE8CB79965313E9D0F877EC78D2FA193CE8AFA7D6BD20AF1D33C8E6E88424A13127EB16053D5667C6B3532240D4C3F6601AD99B8BA49DDD59AC2EE2D03634BF0C67EAEC338301B44423B23847EA3B50B87A98759BCD94F40E97A086FA95AC7A45368BED8AD529CEF9E1A12843EE1398B6E0219099203B77B19029C8BF3A03FC9D3E501D9A68936E08AF7E48BEDC5F9E5BE3DD68BB13040391E2ABB5083508B3FBDB091CD4439A75FFDA5168617E0FFE090120632E12D329471F2E4358760B3739EC4D5D76AB8238DBCF6B83D2D0C31093C8A8C42278AE4015CFAB40236CF0575CD74C41B66E796706C4D18C22E2B2CEB7220D250E680E716CDE00E880FC8B8DADF139FA8865C9F0895A5BAFB71889C819DFF358A15757FF27D8693792D4530445BCBB890CB3884EC07D8D9472DE72A3EA636541EFE8413AFE2C8B99A42C13220AA6FDAC83C4BE1D691DFBA5C71CC80C4061669B7EAB79742B09D33409262C940E57D5DB0C12CAB5FE2779260BB0F40439243B07A44388CCFAB7CAB4F94030753703A1BC4B1C5B7487AA5B537C47ED2F9772536430D7853BD1EFE3DECF2A5F59DDB2722C3BAC7473F99595275C9CBA5D67E326FE09F6908D5D0A3ACA73193110493CA1332DDA102A0440C369759DDE6FB61CE52F76A2B5D66C6B5BEDC07D4CE028B8FFA5A50C604F0E65F48635CC723C69D286A5B9966A9F3D1F9400D190749F21FC16D17BF59AA0993CE82D2D2056D54DD8BA58AD7926A7A7694C0D982B958527EC33B975EF872525F135ED21F92D2B9EE386E378180CF959DC155DEB7FCC5753931C3121C6894B577D712687591B06DC3F74C740CE270D05667C343CF2B4F1BA822CD32464AEDBF682E519E5E23CB5944425368CC382ABDBBCACDD8343335A8AE11597263CCE9B3EEA44C7FA00E98468F6482761D2514670B4633263E53C94596852023EF5954663F18D91EEA32F1C49D5D12175957A39632A7DDF446A7E5288E9C2B3398B80AF9B6E4D72A7AF3D7D5ED2E254BA1EB0DF899364784293BC2324FE7FAE85CC5B149E2E03DC73312C696EEE93A0B502D87502991B50B5529AEECFD0F59952CCAD69229DA92D2DEC9D180271D4C8D8E1522519559A0B7C061877CD2C77AE21302B682A4AFC7E9D60ADA723D29A2A558DA041ABB03D2E9BD338E82C2EA852859A63FAF28D6952CB38606324D253ADBA40CE1ADCD6FC30E8FA252D7608A74106C1CC4F1893BAAF4F00499450E6653691914B5AEB8A3635F09F2B4AFE10F0BEEE700087E6D8BAFDB93822F5F4B8A769568BA148D6600FE9D91BC5792063B301835A2C53B28A69CFB0B7FB1A9608A0E80EB5BC3D9BD64466D27D3FF1CD6C55D6C3924A6F2CD4CA9F5EC9749841487A3B81190AF086DFE25C7438146B1897470845DEA729FB76DDD363FA53B8B953D7153F38E0874CC6B4CB63FEE777EEF750A291CEB110254BEA46F06C819DB991432DB21B8C50E6DC03B839D5F99A88FAB0F111C9CA73DFBBD66B27A242D3299AA349862EFDE0FCD54E1FD4BDACC2F2B0470003CBA7F4D241B5A88E84594DC716274086C05AB5F2C790554752ACAE95AE2BCB177D5F3CBA3DDCBB867C4D641FE3CDB97BF88DD931BB0C710848AD50CDC373BB9B343164E0EDAE6686086332A2AD3CFFDF96EB37C49474FE476453351B11AB4E487CEA6F4456D86D6B71D74E7D72D9347A73F7D1C6E6AF918FEB9793A1FF5A73B4409CABD1D55CFE58D008488684C63E824C9E8140DA6F5492C146C05F6D2F7B4AA5632D159BFFE5013C7403BCCDF3686432BA47980346094B40C059AD34E90C9CA0EFA7161A8086DE8ED91882D3E48CBE1F342F79E1BF0F2A34B5E7876267B6A75C4AA7DC635B7487BA1653F9DCAFB4E9E7D425845C5274F0112043E1DA427D913C7D55F1704ABF379A14FCC6714C9BCB1EB3EC05CB7C705F05947CF9819E257874C9A4DE01F28AC14941238C7FF6204FE383906E1AEE10689F88DEFCB5F64921A4A383503CF9BFB9E2E180E886E962963FA5A25B4A80A7A176BAADF4242CADA006031D6676B9F1E9C87218207A9DBDC755A22AA92E705C099EFE3BCA49E1418FE8EBEA24C9D58493B4E5979D37A0DC6944060B2D14CA60358A3E52908360E4A4ABD7A99A844865E0D2C589F52A22FE4042E423FED5C023F8A1E724B5300263CA98CB9193CBEAAEF9BC21D7AE87D533121A8DCA725203CDFC3F22A8C44497B453633DBD9720AD1E0A3250C071B7A80730609011CBBAF253BE747DF1EDA729B1C565A7D6EEEFCDA8BA011E04E2688E8878244759B0158A2D943CA45824F1A279B265CB05B91A114076452AAED4FD0B3A5448F247C95EBD151763CFA096F82DDF68EA1726970A172DC37A66D52AB3987CD7BAE7E15EF0D57B1AB3BDE97BDAF2AF01B84E11B08E556619837ACFB5B7D5332E748FDDF18D7619C58CF46342CDCC9FB7ECF74C688E0E6747B9E6200C6A834737CBBCFFB594AA3E11EDBB423499B52421B599E3B0D4D619E4AECEA77EBCB1509BF032503413B69EC2EFC5D0516FC028624D88AE686ED9A6EC3EB511DB9194B222C0BE8057D69FAE2D090121686D2D62E64234B1BD30347093A30AC287D8FEB37443A4DE49CC1289602EA6151B7D6349D17991366BF75E390EB5C83AA1CADF4B6B2E28168BBB8FE88097BE1A7BF318E6F8698D0E6C30DDE9878699E3730DDB167F1012DC7EB3FF8ECDE73231953DFB6A6989A1E5A02F152DCCE9E5E7EDA427F0ABA6F97CE468EF13E462AC64919DFB09A7BFE3CA363A79FEA9ACFDF76103722645BEC5477F9742C4E785348FCFF52CAE861FBDBCC6A72F706317C04BD3D04DE895120577797932511F2E4F9D3235842E1834C7911200CD1E04ED81EAE5F3D819B0AA74D4769CDA78C0F6D403B9C4E46E7E665506BCBAE0113D98FC8748F968612557459098EFAAA05F31661507AC864DFCC2CC7A7828B6538F56403C133CA9EF57C7C030C1DA8CFB981DD697FD73346115063329B9DABFB7C386590046FCAD240DFBEA4936DF4937C855CB594FFAA8AFB716AA8AC4FE784B6A5E572C0E43FB2015FD64B999259B487E0F220AC8F88280828A405C1FAB1116EC815759AAB090FBE5F582F406F8F73B2E61445171A7504612C2A49BAB4007BAA432F7F07970C379A0B3A4677A85E626FA9957AFE5426199E3130254916C847AC86C762B0E034184C4C6F2BB64DED9317B2EBBDE172B86AE50D369FE3CD7723A23A01B986F125646E363D7C2119B4E5F4A7871E025F0ABE896987A9294C285EAEC3C9090A6DCCF8BC320B01F472F6C14DFC404567BBEC194B842D1BCF15951B5BB7157990D186E2FFF4F55F7EA33EEC607F4E305EA81D36C6DB248EB035AD914ABCD5D3762897B7B2BC3ED6AEFC46AD91652958D3BBA27A0E3076098D2C4B6754684A449C4391B48E6D27B49C0E2FE49481192C11646994D9540CEF51DDD3CC1BEEB22B7763C5EB57A42F940CFB1E66B47D358894ED7DF30D32B10B9FEEDE8791860ABD241071F4D373F60A903E0DD02CFD9A4D88652F67C5010CEFAB927577851E49F41FB57EDF356D84B772FA7AB4CE3715A75F0375699E2B2EF78B252E0F4E413E0552D275DB8B8F6A363C82F8CBB6ADFD93650B50C2DF78D249BDC1DADFA843015244BAE242E3D42636995DE01223E445C8AB1D2E2E4F30D3075889AB0BABCD2DEFE05093343464A5D6C8082848E9EA8B7BDD9DDE9EBECF9FEFF00000000000000000000000000000000000000000000000000000007121D3593FB956306E33AB6326A0C5FC29E470685223A6364777A5A7621C346C37138610FDFFD8015185CE2D2C746E2E567204B9DF506AD9815CFDBB98576F8D75129B8B80C02D6F0CB56A1F136187F00D80F406269E5DB220CA97A20288F249C6F40F0CE380748EAA8AF1EF54EA3BBF9748FF575892762826C845867A76CAAE8688808FB8743563CCEA914DA2389475BD738EAF5E797F1674AAC25DBD61BE62DE66BB8D29729AF2FC59CB357AC01A739394280DBD626788B650A1B780AD3C9BF8AA413CC489836BAC86BB12B8C88102EED42B2E644B1C05C99E63E228C7A097C48033695D3D9920A1DB480E7F932CFC9AD3B26983CAEE76EDB1E64F88B93C02A6BF4F68B80F533B703057C8F77BB90FB407BF43DDE23DAC834BAF4F2DA28BDF3151B0BB5738DD27DA2C9D097C9D24C13A46871E9254A5CE9D41328B5CE0247060EBD34B9D17B559CFA5F7088B5A6FF29A6D7D9FAAF10D25C25AC8C8D810E34763BA6EEF5C37B4BE1F72080F5A10357252690E217D5637EDE1086A464A3D540096D598FB78502020FE1EB3FD23CAC97B8B44C160BB61452745EE71877A240D7EEA540BBC186959D0074EEAF5FD2CD98600048E6B677018745AC31ABC8E9CD50E612E98BD1C5B16BD45B2922B38523CB1882C5FEDE29032E2BD21E409CE51299D117367F45E95FF2EE785F41CC80935FAE16F6B971758C7D04D36CDDF5B35CA28597ED1CA040D6789B9A5A67A6E5D9969E2EC1B9AFCA7A02A845956A514E8F362258EA6DCA6761EE84D1DA5ED59C56581371003795263622327AD9A416585E051EAE398855DA6B4688FEF00E07841F4D8C9250DB2F3DA0D21771E9011BF1BE5D5D4F2BB63B83ABE4BD4F20E0CF8A18CF8CB0C19D494F6FC99F362E2B926040BF873E3EB81AD5BD6160AEF6978A5F6BB691E2583F7848C12CFE180E1D5B79458DE1A24F362D9AB73DDB609F7895F887FD121F7994B118815A65E840C061C93CF61ED5E2C4909E3C8824BA0D8AA060FA36C3EC53203ADE38A7FE66992147AA7D4F0FBC7821CF08DD60507B5CF1F61425D9E8899231A94AE512169074CBE6574B7E54286439F982E956C09054D194100AEB0FD50EE8FEB627F90B1BDDD463674E80C894E57F8095093774F43B37F085CAAA3160CEB8CA2DC696BAAAB5D554DFF41CCEB1471B994208A2B2F09D4F685CC1147CA28D6AD3771C1D1C551DD193CA4FCD3A9E8208D0873A861C953E78A0D60C3B32F1A99B3C9152540F449EC4D5BA53AAAD424469F2D9089F109A436EA90237158BE83C81C0DC10B530F5AB23F2C8D11FD9C6394B397799EDB309C76A7B6C88570D6C4D80E3C63DDFCB8C7EC5FD11A109A659EF7DF10CEC618BE92E363BFE008ECD118B85175E91E1EE8026ECF02BD67AA06B258F9D304D707896E299894C1751CC6E3B9B110B86EACAEBE5D8BDAED9C107D6C929B48181E094C3CBF2EE101193DA837CF7F922363B4B7E37B0846DE0905C0B817E4901B15F44B34103D018D293270D60B2B8FD8F1596DB992779B8263E18E967C3047EFF94651BE6D52AA1FD9631EA3BCA46D3E1B8382756C28987194430C653A8FC824EBD5977392FFB8F46B3CE73EA74AD4829F12D3BA2069BADCE7AAD1D7D28601768F6B5A6DF4160278D187D696A13EB42C85A1FE684D7F10BC0E44B6F4AA2E6281C3DFC33A8A9757A2BE900CB38B22462CABEA4D1653FC22726D5F92F0AD26790848E743869D865CC207D49D6E4790743CA9FD9AEC62F9373E2A2AFB5DA70FBAD5B96369F85340C3F0190EF1C4540E164A9675CFA0BD9C818A8FCB445CBB29A42B7226916978F811B0855485CEC8D22255C59181165AE04973B5BB095BAD13FF79D9D1E98E1957C416AE4953050E3C9757EA56959D9E673B7503F6A01CFDE9DD9EEA22A5595E8DEBD8BE5C7AE49953BE60533F29680999B79ABDE91320D4740CADDBE6D91DCD39F3D8D487A63BEAD34FAC559C200DC42180C177A36119E3C5B734D6A16481D02AC0203BC23E746A47D088B5119CB28952111424FF7F415183EA6018545EAE51BEE1F76F48C43EFED1FA26C7401503992DA45E2AB7490AD28EF5C7099A05D5A34",
		EthereumSignature: "0x7db87742f8ba5d7ed978d4a290ed11e05f285e223b1a7ea4aada5dabe0c38c2005b4079d8f59d0cbc59137b069257e6b92cabdb57bca90e9a3e4e48e7479c4dc1b",
	}

	//Ethereum signature from https://app.mycrypto.com/sign-message
	//ethPrivateKey := "a09d9a0c4b3cfc7a524a47e9cb6760f8c771ca0c9d83f6624026ac64b6347641

	tempSwap := details.EthAddress
	details.EthAddress = "0xbC22f18344B750Cc46F37375ed7fb607b9C649ca" //last char change
	_, err := VerifyGenesis(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("negative check sfailed")
	}
	details.EthAddress = tempSwap

	tempSwap = details.DepositorAddress
	details.DepositorAddress = "0xeD303665Bf738C649Be0449146C2a3a06BF16fcd291f27F7e6238F3b6eAa1eDA" //last char change
	_, err = VerifyGenesis(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("negative check sfailed")
	}
	details.DepositorAddress = tempSwap

	tempSwap = details.ValidatorAddress
	details.ValidatorAddress = "0xCA35916aE38F1457b3cf72D70dAFBda203AC3a6f441fD8cc875F1724D6a63934" //last char change
	_, err = VerifyGenesis(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("negative check failed")
	}
	details.ValidatorAddress = tempSwap

	tempSwap = details.Amount
	details.Amount = "6000000" //amount change
	_, err = VerifyGenesis(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("negative check failed")
	}
	details.Amount = tempSwap

	tempSwap = details.Message
	details.Message = strings.Replace(details.Message, "5000000", "10000000", 1) //amount change
	_, err = VerifyGenesis(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("negative check failed")
	}
	details.Message = tempSwap

	tempSwap = details.QuantumSignature
	details.QuantumSignature = strings.Replace(details.QuantumSignature, "041F", "041E", 1) //minor change
	_, err = VerifyGenesis(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("negative check failed")
	}
	details.QuantumSignature = tempSwap

	tempSwap = details.EthereumSignature
	details.EthereumSignature = strings.Replace(details.EthereumSignature, "0x7db87", "0x7db89", 1) //minor change
	_, err = VerifyGenesis(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("negative check failed")
	}
	details.EthereumSignature = tempSwap

	fmt.Println("details", details)

	_, err = VerifyGenesis(details)
	if err != nil {
		fmt.Println(err)
		t.Fatalf("positive check failed")
	}
}

func TestConversionStatic(t *testing.T) {
	details := &ConversionSignDetails{
		EthAddress:        "0xAa044ccF6BAD46F0de9fb4dF6b7d9fF02D2e195f",
		QuantumAddress:    "0x8A328B329b2a514863475E17FbB7dA2E207CcF70289313F7e0766cBe8ad25a12",
		EthereumSignature: "0xa25c5e509bd30f8f03e1a56d652b17255ce2e0c00c4b292e3545bc39f62d96550b26c3f4a731e83934d3345cce91904f852164bb1b1dba756e06cf83d1a9083f1b",
	}

	_, err := VerifyConversion(details)
	if err != nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}
}

func TestConversionStatic_Negative(t *testing.T) {
	details := &ConversionSignDetails{
		EthAddress:        "0xAa044ccF6BAD46F0de9fb4dF6b7d9fF02D2e195f",
		QuantumAddress:    "0x8A328B329b2a514863475E17FbB7dA2E207CcF70289313F7e0766cBe8ad25a12",
		EthereumSignature: "0xa25c5e509bd30f8f03e1a56d652b17255ce2e0c00c4b292e3545bc39f62d96550b26c3f4a731e83934d3345cce91904f852164bb1b1dba756e06cf83d1a9083f1b",
	}

	_, err := VerifyConversion(details)
	if err != nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}

	tempSwap := details.EthAddress
	details.EthAddress = "0xAa044ccF6BAD46F0de9fb4dF6b7d9fF02D2e195e" //last byte change
	_, err = VerifyConversion(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}
	details.EthAddress = tempSwap

	tempSwap = details.QuantumAddress
	details.QuantumAddress = "0x8A328B329b2a514863475E17FbB7dA2E207CcF70289313F7e0766cBe8ad25a11" //last byte change
	_, err = VerifyConversion(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}
	details.QuantumAddress = tempSwap

	tempSwap = details.EthereumSignature
	details.EthereumSignature = "0xa25c5e509bd30f8f03e1a56d652b17255ce2e0c00c4b292e3545bc39f62d96550b26c3f4a731e83934d3345cce91904f852164bb1b1dba756e06cf83d1a9083f1c" //last byte change
	_, err = VerifyConversion(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}
	details.EthereumSignature = tempSwap

	tempSwap = details.EthereumSignature
	details.EthereumSignature = "a25c5e509bd30f8f03e1a56d652b17255ce2e0c00c4b292e3545bc39f62d96550b26c3f4a731e83934d3345cce91904f852164bb1b1dba756e06cf83d1a9083f1c" //non hex
	_, err = VerifyConversion(details)
	if err == nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}
	details.EthereumSignature = tempSwap

	_, err = VerifyConversion(details)
	if err != nil {
		fmt.Println(err)
		t.Fatalf("failed")
	}
}
